{"ast":null,"code":"import React from 'react';\nimport * as d3 from \"d3\"; //import { useStore } from 'react-redux'\n\nexport function runForceGraph(container, linksData, nodesData) {\n  //const store = useStore();\n  const links = linksData.map(d => Object.assign({}, d));\n  const nodes = nodesData.map(d => Object.assign({}, d));\n  const containerRect = container.getBoundingClientRect();\n  const height = containerRect.height;\n  const width = containerRect.width;\n\n  const drag = simulation => {\n    const dragstarted = d => {\n      if (!d3.event.active) simulation.alphaTarget(0.3).restart();\n      d.fx = d.x;\n      d.fy = d.y;\n    };\n\n    const dragged = d => {\n      d.fx = d3.event.x;\n      d.fy = d3.event.y;\n    };\n\n    const dragended = d => {\n      if (!d3.event.active) simulation.alphaTarget(0);\n      d.fx = null;\n      d.fy = null;\n    };\n\n    return d3.drag().on(\"start\", dragstarted).on(\"drag\", dragged).on(\"end\", dragended);\n  };\n\n  const getNodeColor = node => {\n    //return node.name === this.props.parent.data ? 'red' : '#0099ff'\n    return '#0099ff';\n  };\n\n  const simulation = d3.forceSimulation(nodes).force(\"link\", d3.forceLink(links).id(d => d.id)).force(\"charge\", d3.forceManyBody().strength(-150)).force(\"x\", d3.forceX()).force(\"y\", d3.forceY());\n  const svg = d3.select(container).append(\"svg\").attr(\"viewBox\", [-width / 2, -height / 2, width, height]).call(d3.zoom().on(\"zoom\", function () {\n    svg.attr(\"transform\", d3.event.transform);\n  }));\n  const link = svg.append(\"g\").attr(\"stroke\", \"#aaa\").attr(\"stroke-opacity\", 0.6).selectAll(\"line\").data(links).join(\"line\").attr(\"stroke-width\", function (d) {\n    return Math.sqrt(d.value) / 10;\n  });\n  const node = svg.append(\"g\").attr(\"stroke\", \"#aaa\").attr(\"stroke-width\", 2).selectAll(\"circle\").data(nodes).join(\"circle\").attr(\"r\", function (d) {\n    return Math.sqrt(d.pubs) * 1.5;\n  }).attr(\"fill\", getNodeColor).call(drag(simulation));\n  node.append(\"title\").text(function (d) {\n    let dc = '';\n    let name = ';';\n\n    if (d.name.indexOf('*') !== -1) {\n      name = d.name.replace('*', '');\n      dc = ' (DECEASED)';\n    } else {\n      name = d.name;\n    }\n\n    name = name.concat(dc);\n    let text = name.concat(\"\\n \");\n    text = text.concat(d.pubs);\n    text = text.concat(\" Coauthor(s) with Erdos number 2\");\n    return text;\n  });\n  simulation.on(\"tick\", () => {\n    //update link positions\n    link.attr(\"x1\", d => d.source.x).attr(\"y1\", d => d.source.y).attr(\"x2\", d => d.target.x).attr(\"y2\", d => d.target.y); // update node positions\n\n    node.attr(\"cx\", d => d.x).attr(\"cy\", d => d.y);\n  });\n  return {\n    destroy: () => {\n      simulation.stop();\n    },\n    nodes: () => {\n      return svg.node();\n    }\n  };\n}","map":{"version":3,"sources":["/Users/peterstephens/Documents/projects/erdos_number/erdos_display/src/components/ForceGraphGenerator.js"],"names":["React","d3","runForceGraph","container","linksData","nodesData","links","map","d","Object","assign","nodes","containerRect","getBoundingClientRect","height","width","drag","simulation","dragstarted","event","active","alphaTarget","restart","fx","x","fy","y","dragged","dragended","on","getNodeColor","node","forceSimulation","force","forceLink","id","forceManyBody","strength","forceX","forceY","svg","select","append","attr","call","zoom","transform","link","selectAll","data","join","Math","sqrt","value","pubs","text","dc","name","indexOf","replace","concat","source","target","destroy","stop"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAO,KAAKC,EAAZ,MAAoB,IAApB,C,CACA;;AAEA,OAAO,SAASC,aAAT,CAAuBC,SAAvB,EAAkCC,SAAlC,EAA6CC,SAA7C,EAAwD;AAE3D;AAEA,QAAMC,KAAK,GAAGF,SAAS,CAACG,GAAV,CAAeC,CAAD,IAAOC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBF,CAAlB,CAArB,CAAd;AACA,QAAMG,KAAK,GAAGN,SAAS,CAACE,GAAV,CAAeC,CAAD,IAAOC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBF,CAAlB,CAArB,CAAd;AAEA,QAAMI,aAAa,GAAGT,SAAS,CAACU,qBAAV,EAAtB;AACA,QAAMC,MAAM,GAAGF,aAAa,CAACE,MAA7B;AACA,QAAMC,KAAK,GAAGH,aAAa,CAACG,KAA5B;;AAEA,QAAMC,IAAI,GAAIC,UAAD,IAAgB;AAC7B,UAAMC,WAAW,GAAIV,CAAD,IAAO;AACvB,UAAI,CAACP,EAAE,CAACkB,KAAH,CAASC,MAAd,EAAsBH,UAAU,CAACI,WAAX,CAAuB,GAAvB,EAA4BC,OAA5B;AACtBd,MAAAA,CAAC,CAACe,EAAF,GAAOf,CAAC,CAACgB,CAAT;AACAhB,MAAAA,CAAC,CAACiB,EAAF,GAAOjB,CAAC,CAACkB,CAAT;AACH,KAJD;;AAMA,UAAMC,OAAO,GAAInB,CAAD,IAAO;AACnBA,MAAAA,CAAC,CAACe,EAAF,GAAOtB,EAAE,CAACkB,KAAH,CAASK,CAAhB;AACAhB,MAAAA,CAAC,CAACiB,EAAF,GAAOxB,EAAE,CAACkB,KAAH,CAASO,CAAhB;AACH,KAHD;;AAKA,UAAME,SAAS,GAAIpB,CAAD,IAAO;AACrB,UAAI,CAACP,EAAE,CAACkB,KAAH,CAASC,MAAd,EAAsBH,UAAU,CAACI,WAAX,CAAuB,CAAvB;AACtBb,MAAAA,CAAC,CAACe,EAAF,GAAO,IAAP;AACAf,MAAAA,CAAC,CAACiB,EAAF,GAAO,IAAP;AACH,KAJD;;AAMA,WAAOxB,EAAE,CAACe,IAAH,GACEa,EADF,CACK,OADL,EACcX,WADd,EAEEW,EAFF,CAEK,MAFL,EAEaF,OAFb,EAGEE,EAHF,CAGK,KAHL,EAGYD,SAHZ,CAAP;AAIC,GAtBD;;AAwBA,QAAME,YAAY,GAAIC,IAAD,IAAU;AAC/B;AACA,WAAO,SAAP;AACC,GAHD;;AAKA,QAAMd,UAAU,GAAGhB,EAAE,CAAC+B,eAAH,CAAmBrB,KAAnB,EACGsB,KADH,CACS,MADT,EACiBhC,EAAE,CAACiC,SAAH,CAAa5B,KAAb,EAAoB6B,EAApB,CAAuB3B,CAAC,IAAIA,CAAC,CAAC2B,EAA9B,CADjB,EAEGF,KAFH,CAES,QAFT,EAEmBhC,EAAE,CAACmC,aAAH,GAAmBC,QAAnB,CAA4B,CAAC,GAA7B,CAFnB,EAGGJ,KAHH,CAGS,GAHT,EAGchC,EAAE,CAACqC,MAAH,EAHd,EAIGL,KAJH,CAIS,GAJT,EAIchC,EAAE,CAACsC,MAAH,EAJd,CAAnB;AAMA,QAAMC,GAAG,GAAGvC,EAAE,CAACwC,MAAH,CAAUtC,SAAV,EACGuC,MADH,CACU,KADV,EAEGC,IAFH,CAEQ,SAFR,EAEmB,CAAC,CAAC5B,KAAD,GAAS,CAAV,EAAa,CAACD,MAAD,GAAU,CAAvB,EAA0BC,KAA1B,EAAiCD,MAAjC,CAFnB,EAGG8B,IAHH,CAGQ3C,EAAE,CAAC4C,IAAH,GAAUhB,EAAV,CAAa,MAAb,EAAqB,YAAY;AACjCW,IAAAA,GAAG,CAACG,IAAJ,CAAS,WAAT,EAAsB1C,EAAE,CAACkB,KAAH,CAAS2B,SAA/B;AAA2C,GAD3C,CAHR,CAAZ;AAOA,QAAMC,IAAI,GAAGP,GAAG,CAACE,MAAJ,CAAW,GAAX,EACIC,IADJ,CACS,QADT,EACmB,MADnB,EAEIA,IAFJ,CAES,gBAFT,EAE2B,GAF3B,EAGIK,SAHJ,CAGc,MAHd,EAIIC,IAJJ,CAIS3C,KAJT,EAKI4C,IALJ,CAKS,MALT,EAMIP,IANJ,CAMS,cANT,EAMyB,UAASnC,CAAT,EAAY;AAAE,WAAO2C,IAAI,CAACC,IAAL,CAAU5C,CAAC,CAAC6C,KAAZ,IAAqB,EAA5B;AAAiC,GANxE,CAAb;AAQA,QAAMtB,IAAI,GAAGS,GAAG,CAACE,MAAJ,CAAW,GAAX,EACIC,IADJ,CACS,QADT,EACmB,MADnB,EAEIA,IAFJ,CAES,cAFT,EAEyB,CAFzB,EAGIK,SAHJ,CAGc,QAHd,EAIIC,IAJJ,CAIStC,KAJT,EAKIuC,IALJ,CAKS,QALT,EAMIP,IANJ,CAMS,GANT,EAMc,UAASnC,CAAT,EAAY;AACnB,WAAO2C,IAAI,CAACC,IAAL,CAAU5C,CAAC,CAAC8C,IAAZ,IAAkB,GAAzB;AACH,GARJ,EASIX,IATJ,CASS,MATT,EASiBb,YATjB,EAUIc,IAVJ,CAUS5B,IAAI,CAACC,UAAD,CAVb,CAAb;AAYAc,EAAAA,IAAI,CAACW,MAAL,CAAY,OAAZ,EACKa,IADL,CACU,UAAS/C,CAAT,EAAY;AACd,QAAIgD,EAAE,GAAG,EAAT;AACA,QAAIC,IAAI,GAAG,GAAX;;AACA,QAAIjD,CAAC,CAACiD,IAAF,CAAOC,OAAP,CAAe,GAAf,MAAwB,CAAC,CAA7B,EAAgC;AAC5BD,MAAAA,IAAI,GAAGjD,CAAC,CAACiD,IAAF,CAAOE,OAAP,CAAe,GAAf,EAAoB,EAApB,CAAP;AACAH,MAAAA,EAAE,GAAG,aAAL;AACH,KAHD,MAIK;AACDC,MAAAA,IAAI,GAAGjD,CAAC,CAACiD,IAAT;AACH;;AACDA,IAAAA,IAAI,GAAGA,IAAI,CAACG,MAAL,CAAYJ,EAAZ,CAAP;AACA,QAAID,IAAI,GAAGE,IAAI,CAACG,MAAL,CAAY,KAAZ,CAAX;AACAL,IAAAA,IAAI,GAAGA,IAAI,CAACK,MAAL,CAAYpD,CAAC,CAAC8C,IAAd,CAAP;AACAC,IAAAA,IAAI,GAAGA,IAAI,CAACK,MAAL,CAAY,kCAAZ,CAAP;AACA,WAAOL,IAAP;AACP,GAhBD;AAkBAtC,EAAAA,UAAU,CAACY,EAAX,CAAc,MAAd,EAAsB,MAAM;AACxB;AACAkB,IAAAA,IAAI,CAACJ,IAAL,CAAU,IAAV,EAAgBnC,CAAC,IAAIA,CAAC,CAACqD,MAAF,CAASrC,CAA9B,EACKmB,IADL,CACU,IADV,EACgBnC,CAAC,IAAIA,CAAC,CAACqD,MAAF,CAASnC,CAD9B,EAEKiB,IAFL,CAEU,IAFV,EAEgBnC,CAAC,IAAIA,CAAC,CAACsD,MAAF,CAAStC,CAF9B,EAGKmB,IAHL,CAGU,IAHV,EAGgBnC,CAAC,IAAIA,CAAC,CAACsD,MAAF,CAASpC,CAH9B,EAFwB,CAOxB;;AACAK,IAAAA,IAAI,CAACY,IAAL,CAAU,IAAV,EAAgBnC,CAAC,IAAIA,CAAC,CAACgB,CAAvB,EACKmB,IADL,CACU,IADV,EACgBnC,CAAC,IAAIA,CAAC,CAACkB,CADvB;AAEH,GAVD;AAYA,SAAO;AACHqC,IAAAA,OAAO,EAAE,MAAM;AACX9C,MAAAA,UAAU,CAAC+C,IAAX;AACH,KAHE;AAIHrD,IAAAA,KAAK,EAAE,MAAM;AACT,aAAO6B,GAAG,CAACT,IAAJ,EAAP;AACH;AANE,GAAP;AAQH","sourcesContent":["import React from 'react'\nimport * as d3 from \"d3\";\n//import { useStore } from 'react-redux'\n\nexport function runForceGraph(container, linksData, nodesData) {\n\n    //const store = useStore();\n\n    const links = linksData.map((d) => Object.assign({}, d));\n    const nodes = nodesData.map((d) => Object.assign({}, d));\n\n    const containerRect = container.getBoundingClientRect();\n    const height = containerRect.height;\n    const width = containerRect.width;\n\n    const drag = (simulation) => {\n    const dragstarted = (d) => {\n        if (!d3.event.active) simulation.alphaTarget(0.3).restart();\n        d.fx = d.x;\n        d.fy = d.y;\n    };\n\n    const dragged = (d) => {\n        d.fx = d3.event.x;\n        d.fy = d3.event.y;\n    };\n\n    const dragended = (d) => {\n        if (!d3.event.active) simulation.alphaTarget(0);\n        d.fx = null;\n        d.fy = null;\n    };\n\n    return d3.drag()\n            .on(\"start\", dragstarted)\n            .on(\"drag\", dragged)\n            .on(\"end\", dragended);\n    };\n\n    const getNodeColor = (node) => {\n    //return node.name === this.props.parent.data ? 'red' : '#0099ff'\n    return('#0099ff')\n    }\n\n    const simulation = d3.forceSimulation(nodes)\n                         .force(\"link\", d3.forceLink(links).id(d => d.id))\n                         .force(\"charge\", d3.forceManyBody().strength(-150))\n                         .force(\"x\", d3.forceX())\n                         .force(\"y\", d3.forceY());\n\n    const svg = d3.select(container)\n                  .append(\"svg\")\n                  .attr(\"viewBox\", [-width / 2, -height / 2, width, height])\n                  .call(d3.zoom().on(\"zoom\", function () {\n                        svg.attr(\"transform\", d3.event.transform);})\n                  );\n\n    const link = svg.append(\"g\")\n                    .attr(\"stroke\", \"#aaa\")\n                    .attr(\"stroke-opacity\", 0.6)\n                    .selectAll(\"line\")\n                    .data(links)\n                    .join(\"line\")\n                    .attr(\"stroke-width\", function(d) { return Math.sqrt(d.value) / 10; });\n\n    const node = svg.append(\"g\")\n                    .attr(\"stroke\", \"#aaa\")\n                    .attr(\"stroke-width\", 2)\n                    .selectAll(\"circle\")\n                    .data(nodes)\n                    .join(\"circle\")\n                    .attr(\"r\", function(d) {\n                        return Math.sqrt(d.pubs)*1.5;\n                    })\n                    .attr(\"fill\", getNodeColor)\n                    .call(drag(simulation));\n\n    node.append(\"title\")\n        .text(function(d) {\n            let dc = '';\n            let name = ';'\n            if (d.name.indexOf('*') !== -1) {\n                name = d.name.replace('*', '');\n                dc = ' (DECEASED)';\n            }\n            else {\n                name = d.name;\n            }\n            name = name.concat(dc);\n            let text = name.concat(\"\\n \");\n            text = text.concat(d.pubs);\n            text = text.concat(\" Coauthor(s) with Erdos number 2\");\n            return text;\n    });\n\n    simulation.on(\"tick\", () => {\n        //update link positions\n        link.attr(\"x1\", d => d.source.x)\n            .attr(\"y1\", d => d.source.y)\n            .attr(\"x2\", d => d.target.x)\n            .attr(\"y2\", d => d.target.y);\n\n        // update node positions\n        node.attr(\"cx\", d => d.x)\n            .attr(\"cy\", d => d.y);\n    });\n\n    return {\n        destroy: () => {\n            simulation.stop();\n        },\n        nodes: () => {\n            return svg.node();\n        }\n    };\n}\n"]},"metadata":{},"sourceType":"module"}