{"ast":null,"code":"import * as d3 from \"d3\"; //import \"@fortawesome/fontawesome-free/css/all.min.css\";\n//import styles from \"./forceGraph.module.css\";\n\nexport function runForceGraph(container, linksData, nodesData) //nodeHoverTooltip\n{\n  const links = linksData.map(d => Object.assign({}, d));\n  const nodes = nodesData.map(d => Object.assign({}, d));\n  const containerRect = container.getBoundingClientRect();\n  const height = containerRect.height;\n  const width = containerRect.width;\n\n  const color = () => {\n    return \"#9D00A0\";\n  };\n\n  const icon = d => {\n    return d.gender === \"male\" ? \"\\uf222\" : \"\\uf221\";\n  };\n\n  const getClass = d => {\n    //return d.gender === \"male\" ? styles.male : styles.female;\n    return d.gender === \"male\";\n  };\n\n  const drag = simulation => {\n    const dragstarted = d => {\n      if (!d3.event.active) simulation.alphaTarget(0.3).restart();\n      d.fx = d.x;\n      d.fy = d.y;\n    };\n\n    const dragged = d => {\n      d.fx = d3.event.x;\n      d.fy = d3.event.y;\n    };\n\n    const dragended = d => {\n      if (!d3.event.active) simulation.alphaTarget(0);\n      d.fx = null;\n      d.fy = null;\n    };\n\n    return d3.drag().on(\"start\", dragstarted).on(\"drag\", dragged).on(\"end\", dragended);\n  }; // Add the tooltip element to the graph\n\n\n  const tooltip = document.querySelector(\"#graph-tooltip\");\n\n  if (!tooltip) {\n    const tooltipDiv = document.createElement(\"div\"); //tooltipDiv.classList.add(styles.tooltip);\n\n    tooltipDiv.style.opacity = \"0\";\n    tooltipDiv.id = \"graph-tooltip\";\n    document.body.appendChild(tooltipDiv);\n  }\n\n  const div = d3.select(\"#graph-tooltip\");\n\n  const addTooltip = (hoverTooltip, d, x, y) => {\n    div.transition().duration(200).style(\"opacity\", 0.9);\n    div.html(hoverTooltip(d)).style(\"left\", `${x}px`).style(\"top\", `${y - 28}px`);\n  };\n\n  const removeTooltip = () => {\n    div.transition().duration(200).style(\"opacity\", 0);\n  };\n\n  const simulation = d3.forceSimulation(nodes).force(\"link\", d3.forceLink(links).id(d => d.id)).force(\"charge\", d3.forceManyBody().strength(-150)).force(\"x\", d3.forceX()).force(\"y\", d3.forceY());\n  const svg = d3.select(container).append(\"svg\").attr(\"viewBox\", [-width / 2, -height / 2, width, height]).call(d3.zoom().on(\"zoom\", function () {\n    svg.attr(\"transform\", d3.event.transform);\n  }));\n  const link = svg.append(\"g\").attr(\"stroke\", \"#999\").attr(\"stroke-opacity\", 0.6).selectAll(\"line\").data(links).join(\"line\").attr(\"stroke-width\", d => Math.sqrt(d.value));\n  const node = svg.append(\"g\").attr(\"stroke\", \"#fff\").attr(\"stroke-width\", 2).selectAll(\"circle\").data(nodes).join(\"circle\").attr(\"r\", 12).attr(\"fill\", color).call(drag(simulation));\n  const label = svg.append(\"g\").attr(\"class\", \"labels\").selectAll(\"text\").data(nodes).enter().append(\"text\").attr('text-anchor', 'middle').attr('dominant-baseline', 'central').attr(\"class\", d => `fa ${getClass(d)}`).text(d => {\n    return icon(d);\n  }).call(drag(simulation));\n  label.on(\"mouseover\", d => {//addTooltip(nodeHoverTooltip, d, d3.event.pageX, d3.event.pageY);\n  }).on(\"mouseout\", () => {\n    removeTooltip();\n  });\n  simulation.on(\"tick\", () => {\n    //update link positions\n    link.attr(\"x1\", d => d.source.x).attr(\"y1\", d => d.source.y).attr(\"x2\", d => d.target.x).attr(\"y2\", d => d.target.y); // update node positions\n\n    node.attr(\"cx\", d => d.x).attr(\"cy\", d => d.y); // update label positions\n\n    label.attr(\"x\", d => {\n      return d.x;\n    }).attr(\"y\", d => {\n      return d.y;\n    });\n  });\n  return {\n    destroy: () => {\n      simulation.stop();\n    },\n    nodes: () => {\n      return svg.node();\n    }\n  };\n}","map":{"version":3,"sources":["/Users/peterstephens/Documents/projects/erdos_number/erdos_display/src/components/ForceGraphGenerator.js"],"names":["d3","runForceGraph","container","linksData","nodesData","links","map","d","Object","assign","nodes","containerRect","getBoundingClientRect","height","width","color","icon","gender","getClass","drag","simulation","dragstarted","event","active","alphaTarget","restart","fx","x","fy","y","dragged","dragended","on","tooltip","document","querySelector","tooltipDiv","createElement","style","opacity","id","body","appendChild","div","select","addTooltip","hoverTooltip","transition","duration","html","removeTooltip","forceSimulation","force","forceLink","forceManyBody","strength","forceX","forceY","svg","append","attr","call","zoom","transform","link","selectAll","data","join","Math","sqrt","value","node","label","enter","text","source","target","destroy","stop"],"mappings":"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","sourcesContent":["import * as d3 from \"d3\";\n//import \"@fortawesome/fontawesome-free/css/all.min.css\";\n//import styles from \"./forceGraph.module.css\";\n\nexport function runForceGraph(\n  container,\n  linksData,\n  nodesData,\n  //nodeHoverTooltip\n) {\n  const links = linksData.map((d) => Object.assign({}, d));\n  const nodes = nodesData.map((d) => Object.assign({}, d));\n\n  const containerRect = container.getBoundingClientRect();\n  const height = containerRect.height;\n  const width = containerRect.width;\n\n  const color = () => { return \"#9D00A0\"; };\n\n  const icon = (d) => {\n    return d.gender === \"male\" ? \"\\uf222\" : \"\\uf221\";\n  }\n\n  const getClass = (d) => {\n    //return d.gender === \"male\" ? styles.male : styles.female;\n    return d.gender === \"male\" ;\n  };\n\n  const drag = (simulation) => {\n    const dragstarted = (d) => {\n      if (!d3.event.active) simulation.alphaTarget(0.3).restart();\n      d.fx = d.x;\n      d.fy = d.y;\n    };\n\n    const dragged = (d) => {\n      d.fx = d3.event.x;\n      d.fy = d3.event.y;\n    };\n\n    const dragended = (d) => {\n      if (!d3.event.active) simulation.alphaTarget(0);\n      d.fx = null;\n      d.fy = null;\n    };\n\n    return d3\n      .drag()\n      .on(\"start\", dragstarted)\n      .on(\"drag\", dragged)\n      .on(\"end\", dragended);\n  };\n\n  // Add the tooltip element to the graph\n  const tooltip = document.querySelector(\"#graph-tooltip\");\n  if (!tooltip) {\n    const tooltipDiv = document.createElement(\"div\");\n    //tooltipDiv.classList.add(styles.tooltip);\n    tooltipDiv.style.opacity = \"0\";\n    tooltipDiv.id = \"graph-tooltip\";\n    document.body.appendChild(tooltipDiv);\n  }\n  const div = d3.select(\"#graph-tooltip\");\n\n  const addTooltip = (hoverTooltip, d, x, y) => {\n    div\n      .transition()\n      .duration(200)\n      .style(\"opacity\", 0.9);\n    div\n      .html(hoverTooltip(d))\n      .style(\"left\", `${x}px`)\n      .style(\"top\", `${y - 28}px`);\n  };\n\n  const removeTooltip = () => {\n    div\n      .transition()\n      .duration(200)\n      .style(\"opacity\", 0);\n  };\n\n  const simulation = d3\n    .forceSimulation(nodes)\n    .force(\"link\", d3.forceLink(links).id(d => d.id))\n    .force(\"charge\", d3.forceManyBody().strength(-150))\n    .force(\"x\", d3.forceX())\n    .force(\"y\", d3.forceY());\n\n  const svg = d3\n    .select(container)\n    .append(\"svg\")\n    .attr(\"viewBox\", [-width / 2, -height / 2, width, height])\n    .call(d3.zoom().on(\"zoom\", function () {\n      svg.attr(\"transform\", d3.event.transform);\n    }));\n\n  const link = svg\n    .append(\"g\")\n    .attr(\"stroke\", \"#999\")\n    .attr(\"stroke-opacity\", 0.6)\n    .selectAll(\"line\")\n    .data(links)\n    .join(\"line\")\n    .attr(\"stroke-width\", d => Math.sqrt(d.value));\n\n  const node = svg\n    .append(\"g\")\n    .attr(\"stroke\", \"#fff\")\n    .attr(\"stroke-width\", 2)\n    .selectAll(\"circle\")\n    .data(nodes)\n    .join(\"circle\")\n    .attr(\"r\", 12)\n    .attr(\"fill\", color)\n    .call(drag(simulation));\n\n  const label = svg.append(\"g\")\n    .attr(\"class\", \"labels\")\n    .selectAll(\"text\")\n    .data(nodes)\n    .enter()\n    .append(\"text\")\n    .attr('text-anchor', 'middle')\n    .attr('dominant-baseline', 'central')\n    .attr(\"class\", d => `fa ${getClass(d)}`)\n    .text(d => {return icon(d);})\n    .call(drag(simulation));\n\n  label.on(\"mouseover\", (d) => {\n    //addTooltip(nodeHoverTooltip, d, d3.event.pageX, d3.event.pageY);\n  })\n    .on(\"mouseout\", () => {\n      removeTooltip();\n    });\n\n  simulation.on(\"tick\", () => {\n    //update link positions\n    link\n      .attr(\"x1\", d => d.source.x)\n      .attr(\"y1\", d => d.source.y)\n      .attr(\"x2\", d => d.target.x)\n      .attr(\"y2\", d => d.target.y);\n\n    // update node positions\n    node\n      .attr(\"cx\", d => d.x)\n      .attr(\"cy\", d => d.y);\n\n    // update label positions\n    label\n      .attr(\"x\", d => { return d.x; })\n      .attr(\"y\", d => { return d.y; })\n  });\n\n  return {\n    destroy: () => {\n      simulation.stop();\n    },\n    nodes: () => {\n      return svg.node();\n    }\n  };\n}\n"]},"metadata":{},"sourceType":"module"}